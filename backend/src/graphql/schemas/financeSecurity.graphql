"""
Finance Security Schema - Admin Dashboard Types
"""

type AuditLog {
  id: ID!
  adminId: String!
  admin: User
  action: String!
  resource: String!
  resourceId: String
  details: JSON!
  ipAddress: String!
  userAgent: String!
  status: String!
  timestamp: DateTime!
}

type AuditLogStats {
  totalLogs: Int!
  byAction: JSON!
  byResource: JSON!
  byStatus: JSON!
  byAdmin: [AdminActivity!]!
  suspiciousActivities: Int!
  failedOperations: Int!
}

type AdminActivity {
  adminId: String!
  adminName: String!
  count: Int!
  lastAction: DateTime!
}

type FraudStats {
  totalAlertsTriggered: Int!
  walletsLocked: Int!
  flaggedTransactions: Int!
  averageRiskScore: Float!
  topRiskUsers: [RiskUser!]!
}

type RiskUser {
  userId: String!
  username: String!
  riskScore: Float!
}

type UserRiskProfile {
  userId: String!
  riskScore: Float!
  flags: [String!]!
  lastActivity: DateTime!
  suspiciousActivityCount: Int!
  walletLocked: Boolean!
}

type BlockchainSyncStatus {
  isRunning: Boolean!
  lastSyncedBlock: Int!
  currentBlock: Int
  lag: Int
}

type ExportResult {
  success: Boolean!
  format: String!
  content: String!
  filename: String!
}

type SecurityActionResult {
  success: Boolean!
  message: String!
}

type ArchiveResult {
  success: Boolean!
  message: String!
  archivedCount: Int!
}

extend type Query {
  """Get security audit logs with filters"""
  financeSecurityAuditLogs(
    adminId: String
    action: String
    resource: String
    startDate: DateTime
    endDate: DateTime
    limit: Int
    offset: Int
  ): [AuditLog!]!

  """Get audit log statistics"""
  financeSecurityStats(
    startDate: DateTime
    endDate: DateTime
  ): AuditLogStats!

  """Get suspicious activity logs"""
  financeSuspiciousActivities(days: Int): [AuditLog!]!

  """Get failed operations"""
  financeFailedOperations(days: Int): [AuditLog!]!

  """Get fraud monitoring statistics"""
  financeFraudStats(days: Int): FraudStats!

  """Get user risk profile"""
  financeUserRiskProfile(userId: ID!): UserRiskProfile!

  """Get blockchain sync status"""
  financeBlockchainSyncStatus: BlockchainSyncStatus!
}

extend type Mutation {
  """Export audit logs to CSV or JSON"""
  financeExportAuditLogs(
    format: ExportFormat!
    adminId: String
    action: String
    startDate: DateTime
    endDate: DateTime
  ): ExportResult!

  """Send manual security alert to user"""
  financeSendSecurityAlert(
    userId: ID!
    alertType: String!
    message: String!
  ): SecurityActionResult!

  """Lock user wallet manually (Super Admin only)"""
  financeLockWallet(
    userId: ID!
    reason: String!
  ): SecurityActionResult!

  """Unlock user wallet manually (Super Admin only)"""
  financeUnlockWallet(
    userId: ID!
    reason: String!
  ): SecurityActionResult!

  """Add IP address to whitelist (Super Admin only)"""
  financeAddIPWhitelist(
    ipAddress: String!
    reason: String!
  ): SecurityActionResult!

  """Remove IP address from whitelist (Super Admin only)"""
  financeRemoveIPWhitelist(
    ipAddress: String!
    reason: String!
  ): SecurityActionResult!

  """Archive old audit logs (Super Admin only)"""
  financeArchiveOldLogs(daysToKeep: Int): ArchiveResult!
}

enum ExportFormat {
  CSV
  JSON
}
